<!DOCTYPE html>
<html>
<head>

<title>Connect 4</title>

<script src="../jquery.js"></script>
<script src="../raphael/raphael.js"></script>

<style type="text/css">
body{
  width:641px;
  margin:0 auto;
}
h1, h1+p{
  margin:0;
}
</style>

</head>
<body>

<h1>Connect 4</h1>

<p>by <a href="http://github.com/laughinghan">Han</a>

<div id="paper"></div>

<script type="text/javascript">
(function(){
  var swap = {red: 'yellow', yellow: 'red'};

  var paper = Raphael('paper', 641, 641), $paper = $('#paper');
  paper.rect(.5, 90.5, 640, 550)
  for(var i = 0; i < 7; i += 1)
    for(var j = 0; j < 6; j += 1)
      paper.circle(50.5 + i*90, 140.5 + j*90, 40);

  var phantom = $(), i, board = [[], [], [], [], [], [], []], currentColor = 'red';
  $paper.mousemove(function(e){
    phantom.remove();
    i = ~~((e.offsetX-5)/90);
    if(i === 7) i = 6; //the rightmost edge of the board
    phantom = paper.circle(50.5 + i*90, 40.5, 40).attr({stroke: 'none', fill: currentColor});
  }).mouseleave(function(){
    phantom.remove();
  }).click(function(){
    board[i].push(phantom.clone().animate({cy: 140.5 + (5-board[i].length)*90}, 1000, 'bounce'));
    phantom.remove();
    currentColor = swap[currentColor];
  });
}());
</script>

</body>
</html>